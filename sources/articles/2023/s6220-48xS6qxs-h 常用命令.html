<!DOCTYPE html>
<html>

<head>
    <title>Stream内存测试工具</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism.css" />
    <link rel="stylesheet" href="../../css/home_style.css">
    <link rel="stylesheet" href="../../css/index_style.css">
</head>

<body>
    <div class="container-fluid">
        <div class="row" id="head">
            <div class="col" id="logo">
                <a href="../home.html">
                    <img src="../../img/logo.png" alt="">
                    <span>陈可微</span>
                </a>
            </div>

            <div class="col" id="navigation">
                <a href="../archive.html">
                    <span>归档</span>
                </a>
                <a href="tags.html">
                    <span>标签</span>
                </a>
                <a href="">
                    <span>订阅</span>
                </a>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col">
                <p>Stream内存测试工具</p>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <img src="../../img/logo.png" alt="">
                <span>陈可微</span>
                <span class="body_articles_tag"><a href="">[Stream 内存测试]</a></span>
            </div>
        </div>
    </div>
    <div class="container">
        <img src="" alt="">
    </div>
    <div class="container">
        <h4>算法解析</h4>

<table>
<thead>
<tr>
<th align="center">组名</th>
<th align="center">描述</th>
<th align="center">解析</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">Copy</td>
<td align="center">复制操作</td>
<td align="center">从内存单元中读取一个数，并复制到其他内存单元中，两次访问内存操作</td>
</tr>

<tr>
<td align="center">Scale</td>
<td align="center">乘法操作</td>
<td align="center">从内存单元中读取一个数，与常数相乘，得到的结果写入其他内存单元，两次访问内存操作</td>
</tr>

<tr>
<td align="center">Add</td>
<td align="center">矢量求和</td>
<td align="center">从两个内存单元中分别读取两个数，相加后，得到的结果写入另一个内存单元中，三次访问内存操作</td>
</tr>

<tr>
<td align="center">Triad</td>
<td align="center">复合矢量求和</td>
<td align="center">先从内存中读取一个数，与一个常数相乘得到一个乘积，然后从另一个内存单元中读取一个数与刚才乘积结果再相加，得到的结果写入内存。三次访问内存操作</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
<th align="center">name</th>
<th align="center">kernel</th>
<th align="center">bytes/iter</th>
<th align="center">FLOPS/iter</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">Copy</td>
<td align="center">a(i) = b(i)</td>
<td align="center">16</td>
<td align="center">0</td>
</tr>

<tr>
<td align="center">Scale</td>
<td align="center">a(i) = q*b(i)</td>
<td align="center">16</td>
<td align="center">1</td>
</tr>

<tr>
<td align="center">Sum</td>
<td align="center">a(i) = b(i) + c(i)</td>
<td align="center">24</td>
<td align="center">1</td>
</tr>

<tr>
<td align="center">Triad</td>
<td align="center">a(i) = b(i) + q*c(i)</td>
<td align="center">24</td>
<td align="center">2</td>
</tr>
</tbody>
</table>

<h4>编译参数解析</h4>

<table>
<thead>
<tr>
<th align="center">参数</th>
<th align="center">描述</th>
<th align="center">值</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">-O3</td>
<td align="center">编译优化级别</td>
<td align="center">1-3</td>
</tr>

<tr>
<td align="center">-fopenmp</td>
<td align="center">启用多线程</td>
<td align="center"></td>
</tr>

<tr>
<td align="center">-DNTIMES</td>
<td align="center">测试次数，多次则取平均值</td>
<td align="center">int</td>
</tr>

<tr>
<td align="center">-DSTREAM_ARRAY_SIZE</td>
<td align="center">测试数组大小，结果取整</td>
<td align="center">(cpu3级缓存大小*MB)*1024**1024*<em>4.1</em>(cpu路数/8)</td>
</tr>
</tbody>
</table>

<h3>测试</h3>

<h4>对照参数：多线程：开启</h4>

<pre><code>    测试编译优化级别：1
    数组大小：(9*MB)*1024*1024*4.1*(12/8)
    测试次数：10
    gcc -O1 -fopenmp -DSTREAM_ARRAY_SIZE=58038681 -DNTIMES=10 stream.c -o stream
</code></pre>

<p>测试结果：
<img src="../../img/stream/1.png" alt="img" /></p>

<pre><code>    测试编译优化级别：2
    多线程：开启
    数组大小：(9*MB)*1024*1024*4.1*(12/8)
    测试次数：10
    gcc -O2 -fopenmp -DSTREAM_ARRAY_SIZE=58038681 -DNTIMES=10 stream.c -o stream
</code></pre>

<p>测试结果：
<img src="../../img/stream/2.png" alt="img" /></p>

<pre><code>    测试编译优化级别：3
    多线程：开启
    数组大小：(9*MB)*1024*1024*4.1*(12/8)
    测试次数：10
    gcc -O3 -fopenmp -DSTREAM_ARRAY_SIZE=58038681 -DNTIMES=10 stream.c -o stream
</code></pre>

<p>测试结果：
<img src="../../img/stream/3.png" alt="img" /></p>

<pre><code>    对照参数：多线程：关闭
    测试编译优化级别：1
    数组大小：(9*MB)*1024*1024*4.1*(12/8)
    测试次数：10
    gcc -O1 -DSTREAM_ARRAY_SIZE=58038681 -DNTIMES=10 stream.c -o stream
</code></pre>

<p>测试结果：
<img src="../../img/stream/4.png" alt="img" /></p>

<pre><code>    对照参数：多线程：关闭
    测试编译优化级别：2
    数组大小：(9*MB)*1024*1024*4.1*(12/8)
    测试次数：10
    gcc -O2 -DSTREAM_ARRAY_SIZE=58038681 -DNTIMES=10 stream.c -o stream
</code></pre>

<p>测试结果：
<img src="../../img/stream/5.png" alt="img" /></p>

<h4>对照参数：多线程：关闭</h4>

<pre><code>    测试编译优化级别：3
    数组大小：(9*MB)*1024*1024*4.1*(12/8)
    测试次数：10
    gcc -O3 -DSTREAM_ARRAY_SIZE=58038681 -DNTIMES=10 stream.c -o stream
</code></pre>

<p>测试结果：
<img src="../../img/stream/6.png" alt="img" /></p>

<h3>参考文献</h3>

<p><a href="https://www.cnblogs.com/iouwenbo/p/14377478.html">Stream内存测试工具</a>
<a href="http://www.cs.virginia.edu/stream/FTP/Code/stream.c">官方源码地址</a></p>

    </div>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.2/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script>
    window.onload = function () {
        Prism.highlightAll();
    }
</script>