<!DOCTYPE html>
<html>

<head>
    <title>phpipam搭建</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism.css" />
    <link rel="stylesheet" href="../../css/home_style.css">
    <link rel="stylesheet" href="../../css/index_style.css">
</head>

<body>
  <div class="container-fluid" id="search-div">
    <input type="text" class="form-control" placeholder="搜索..." aria-label="搜索..." id="search">
    <div id="search-results"></div>
  </div>
    <div class="wc">
    <div class="container-fluid">
        <div class="row" id="head">
            <div class="col" id="logo">
              <a href="home.html">
                
                
              </a>
            </div>
      
            
            <div class="container-fluid">
              <div class="row" id="head">
                
        
                <div class="col" id="navigation">
                  <a href="../archive.html">
                    <span><svg t="1685179184504" class="icon" viewBox="0 0 1024 1024" version="1.1"
                        xmlns="http://www.w3.org/2000/svg" p-id="8572" width="200" height="200">
                        <path
                          d="M170.8 767.6c0 47.2 38.2 85.4 85.4 85.4h512.2c47.1 0 85.4-38.2 85.4-85.4V426.1h-683v341.5z m597.6-512.2H469.6c0-47.2-38.2-85.4-85.4-85.4h-128c-47.1 0-85.4 38.2-85.4 85.4v128.1h683v-42.7c-0.1-47.2-38.3-85.4-85.4-85.4z"
                          fill="#160202" p-id="8573"></path>
                      </svg></span>
                  </a>
        
                  <a href="../tags.html">
                    <span><svg t="1685179222324" class="icon" viewBox="0 0 1024 1024" version="1.1"
                        xmlns="http://www.w3.org/2000/svg" p-id="9564" width="200" height="200">
                        <path
                          d="M788.48 629.418667c0-17.066667-5.802667-31.744-17.749333-44.714667L421.205333 235.861333c-12.288-12.288-29.354667-22.869333-49.834667-31.744-21.162667-8.874667-39.936-12.970667-57.002667-12.970667L110.933333 191.146667c-17.066667 0-31.744 6.485333-44.032 18.773333-12.288 12.288-18.773333 26.965333-18.773333 44.032l0 202.752c0 17.066667 4.096 36.522667 12.970667 57.002667 8.874667 21.162667 18.773333 37.546667 31.744 49.834667l349.525333 349.525333c12.288 12.288 26.965333 17.749333 44.032 17.749333 17.066667 0 31.744-5.802667 44.714667-17.749333l239.616-239.616C781.994667 661.162667 788.48 646.485333 788.48 629.418667L788.48 629.418667 788.48 629.418667zM248.490667 392.192c-12.288 12.288-26.965333 18.090667-44.032 18.090667-17.066667 0-31.744-5.802667-44.032-18.090667-12.288-12.288-18.090667-26.965333-18.090667-44.032 0-17.066667 5.802667-31.744 18.090667-44.032 12.288-12.288 26.965333-18.090667 44.032-18.090667 17.066667 0 31.744 5.802667 44.032 18.090667C260.778667 316.416 266.24 331.093333 266.24 348.16 267.264 365.568 260.778667 379.904 248.490667 392.192L248.490667 392.192 248.490667 392.192zM958.122667 584.362667 608.597333 235.861333c-12.288-12.288-29.354667-22.869333-49.834667-31.744C537.6 195.242667 518.826667 191.146667 501.76 191.146667l-109.909333 0c17.066667 0 36.522667 4.096 57.002667 12.970667 21.162667 8.874667 37.546667 18.773333 49.834667 31.744l349.525333 348.501333c12.288 12.970667 18.090667 27.648 18.090667 44.714667s-5.802667 31.744-18.090667 44.032l-229.034667 229.717333c9.898667 9.898667 18.773333 17.066667 25.941333 21.845333 7.168 4.778667 17.066667 6.485333 28.672 6.485333 17.066667 0 31.744-5.802667 44.714667-18.090667l239.616-240.298667c12.288-12.288 17.749333-26.965333 17.749333-44.032S970.069333 597.674667 958.122667 584.362667L958.122667 584.362667 958.122667 584.362667zM958.122667 584.362667"
                          fill="#272636" p-id="9565"></path>
                      </svg></span>
                  </a>
        
                  <a href="https://github.com/Metroyy/blog.git">
                    <svg t="1685179323760" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                      p-id="3112" width="200" height="200">
                      <path
                        d="M960 512c0 97.76-28.704 185.216-85.664 263.264-56.96 78.016-130.496 131.84-220.64 161.856-10.304 1.824-18.368 0.448-22.848-4.032a22.4 22.4 0 0 1-7.2-17.504v-122.88c0-37.632-10.304-65.44-30.464-82.912a409.856 409.856 0 0 0 59.616-10.368 222.752 222.752 0 0 0 54.72-22.816c18.848-10.784 34.528-23.36 47.104-38.592 12.544-15.232 22.848-35.904 30.912-61.44 8.096-25.568 12.128-54.688 12.128-87.904 0-47.072-15.232-86.976-46.208-120.16 14.368-35.456 13.024-74.912-4.48-118.848-10.752-3.616-26.432-1.344-47.072 6.272s-38.56 16.16-53.824 25.568l-21.984 13.888c-36.32-10.304-73.536-15.232-112.096-15.232s-75.776 4.928-112.096 15.232a444.48 444.48 0 0 0-24.672-15.68c-10.336-6.272-26.464-13.888-48.896-22.432-21.952-8.96-39.008-11.232-50.24-8.064-17.024 43.936-18.368 83.424-4.032 118.848-30.496 33.632-46.176 73.536-46.176 120.608 0 33.216 4.032 62.336 12.128 87.456 8.032 25.12 18.368 45.76 30.496 61.44 12.544 15.68 28.224 28.704 47.072 39.04 18.848 10.304 37.216 17.92 54.72 22.816a409.6 409.6 0 0 0 59.648 10.368c-15.712 13.856-25.12 34.048-28.704 60.064a99.744 99.744 0 0 1-26.464 8.512 178.208 178.208 0 0 1-33.184 2.688c-13.024 0-25.568-4.032-38.144-12.544-12.544-8.512-23.296-20.64-32.256-36.32a97.472 97.472 0 0 0-28.256-30.496c-11.232-8.064-21.088-12.576-28.704-13.92l-11.648-1.792c-8.096 0-13.92 0.928-17.056 2.688-3.136 1.792-4.032 4.032-2.688 6.72s3.136 5.408 5.376 8.096 4.928 4.928 7.616 7.168l4.032 2.688c8.544 4.032 17.056 11.232 25.568 21.984 8.544 10.752 14.368 20.64 18.4 29.6l5.824 13.44c4.928 14.816 13.44 26.912 25.568 35.872 12.096 8.992 25.088 14.816 39.008 17.504 13.888 2.688 27.36 4.032 40.352 4.032s23.776-0.448 32.288-2.24l13.472-2.24c0 14.784 0 32.288 0.416 52.032 0 19.744 0.48 30.496 0.48 31.392a22.624 22.624 0 0 1-7.648 17.472c-4.928 4.48-12.992 5.824-23.296 4.032-90.144-30.048-163.68-83.84-220.64-161.888C92.256 697.216 64 609.312 64 512c0-81.152 20.192-156.064 60.096-224.672s94.176-122.88 163.232-163.232C355.936 84.192 430.816 64 512 64s156.064 20.192 224.672 60.096 122.88 94.176 163.232 163.232C939.808 355.488 960 430.848 960 512"
                        fill="#000000" p-id="3113"></path>
                    </svg>
                  </a>
        
                  <a href="" id="search-icon" onclick="return false">
                    <span><svg t="1685179444121" class="icon" viewBox="0 0 1024 1024" version="1.1"
                        xmlns="http://www.w3.org/2000/svg" p-id="5939" width="200" height="200">
                        <path
                          d="M907.815385 840.861538L720.738462 653.784615c42.141538-55.926154 66.953846-125.636923 66.953846-200.861538 0-184.713846-150.055385-334.769231-334.769231-334.769231s-334.769231 150.055385-334.769231 334.769231 150.055385 334.769231 334.769231 334.769231c75.224615 0 144.935385-24.812308 200.861538-66.953846l187.076923 187.076923 66.953847-66.953847zM212.676923 452.923077c0-132.332308 107.913846-240.246154 240.246154-240.246154s240.246154 107.913846 240.246154 240.246154-107.913846 240.246154-240.246154 240.246154-240.246154-107.913846-240.246154-240.246154z"
                          fill="#333333" p-id="5940"></path>
                      </svg></span>
                  </a>
                </div>
              </div>
            </div>
          </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col">
                <p>phpipam搭建</p>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <a href="../home.html">
                <img src="../../img/logo.png" alt="">
            </a>
                <span>陈可微</span>
                <span class="body_articles_tag"><a href="">[phpipam]</a></span>
            </div>
        </div>
    </div>
    <div class="container">
        <img src="" alt="">
    </div>
    <div class="container">
        <h3>手动部署phpipam</h3>

<p><strong>前置:无Apache，MySQL，php</strong>
<strong>禁用SELINUX，重启服务器</strong></p>

<pre><code class="language-bash">sed -i '/SELINUX/s/enforcing/disabled/' /etc/selinux/config &amp;&amp; reboot
</code></pre>

<p><strong>关闭防火墙</strong></p>

<pre><code class="language-bash">systemctl stop firewalld
</code></pre>

<p><strong>安装依赖包</strong></p>

<pre><code class="language-bash">yum install epel-release -y
yum install wget vim net-tools httpd mariadb-server 
php php-cli php-gd php-common php-ldap php-pdo php-pear
php-snmp php-xml php-mysql php-mbstring git -y
</code></pre>

<h3>初始化Apache</h3>

<p><strong>修改/etc/httpd/conf/httpd.conf</strong></p>

<pre><code class="language-yaml">ServerName localhost:80
</code></pre>

<p><strong>允许mod_rewrite URL重写</strong></p>

<pre><code class="language-yaml">&lt;Directory &quot;/var/www/html&quot;&gt;
 Options FollowSymLinks
 AllowOverride all
 Order allow,deny
 Allow from all
&lt;/Directory&gt;
</code></pre>

<p><strong>检查配置文件，显示 OK 状态为正常</strong></p>

<pre><code class="language-yaml">httpd -t -f /etc/httpd/conf/httpd.conf
</code></pre>

<p><strong>修改/etc/php.ini时区</strong></p>

<pre><code class="language-yaml">date.timezone = Asia/Shanghai
</code></pre>

<p><strong>开机启动Apache</strong></p>

<pre><code class="language-bash">systemctl enable httpd
</code></pre>

<p><strong>启动Apache</strong></p>

<pre><code class="language-bash">systemctl start httpd
</code></pre>

<h3>初始化mariadb</h3>

<p><strong>开机启动mariadb</strong></p>

<pre><code class="language-bash">systemctl enable mariadb
</code></pre>

<p><strong>启动mariadb</strong></p>

<pre><code class="language-bash">systemctl start mariadb
</code></pre>

<p><strong>初始化mariaDB密码</strong></p>

<pre><code class="language-bash">mysql_secure_installation
</code></pre>

<h3>初始化phpipam</h3>

<p><strong>下载phpipam</strong></p>

<pre><code class="language-bash">cd /var/www/html/
git clone https://github.com/phpipam/phpipam.git .
git checkout 1.4
</code></pre>

<p><strong>权限配置</strong></p>

<pre><code class="language-bash">chown apache:apache -R /var/www/html/
</code></pre>

<p><strong>拷贝文件</strong></p>

<pre><code class="language-bash">cp /var/www/html/config.dist.php /var/www/html/config.dist.php.bak
mv /var/www/html/config.dist.php /var/www/html/config.php
</code></pre>

<p><strong>编辑/var/www/html/config.php</strong></p>

<pre><code class="language-yaml">define('BASE', &quot;/phpipam&quot;); 
</code></pre>

<p><strong>重启httpd</strong></p>

<pre><code class="language-bash">systemctl restart httpd
</code></pre>

<h3>docker部署phpipam</h3>

<pre><code class="language-bash">vi docker-compose.yml
#添加配置
</code></pre>

<blockquote>
<pre><code class="language-bash">&gt; # WARNING: Replace the example passwords with secure secrets.
&gt; # WARNING: 'my_secret_phpipam_pass' and 'my_secret_mysql_root_pass'
&gt;
&gt; version: '3'
&gt;
&gt; services:
&gt;   phpipam-web:
&gt;     privileged: true ---特级权限
&gt;     image: phpipam/phpipam-www:latest
&gt;     ports: ---添加一条映射到本地端口
&gt;       - &quot;64080:80&quot;
&gt;     environment:
&gt;       - TZ=Asia/Shanghai
&gt;       - IPAM_DATABASE_HOST=phpipam-mariadb
&gt;       - IPAM_DATABASE_PASS=password ---修改密码
&gt;       - IPAM_DATABASE_WEBHOST=%
&gt;     restart: unless-stopped
&gt;     volumes:
&gt;       - phpipam-logo:/phpipam/css/images/logo
&gt;     depends_on:
&gt;       - phpipam-mariadb
&gt;
&gt;   phpipam-cron:
&gt;     privileged: true ---特级权限
&gt;     image: phpipam/phpipam-cron:latest
&gt;     environment:
&gt;       - TZ=Asia/Shanghai
&gt;       - IPAM_DATABASE_HOST=phpipam-mariadb
&gt;       - IPAM_DATABASE_PASS=password ---修改密码
&gt;       - SCAN_INTERVAL=1h
&gt;     restart: unless-stopped
&gt;     depends_on:
&gt;       - phpipam-mariadb
&gt;
&gt;   phpipam-mariadb:
&gt;     privileged: true ---特级权限
&gt;     image: mariadb:latest
&gt;     ports: ---mysql端口映射
&gt;       - &quot;3306:3306&quot; 
&gt;     environment:
&gt;       - MYSQL_ROOT_PASSWORD=password ---修改mysql密码
&gt;     restart: unless-stopped
&gt;     command: ---添加command 设置拉取的mysql镜像支持中文
&gt;       - mysqld
&gt;       - --character-set-server=utf8mb4
&gt;       - --collation-server=utf8mb4_unicode_ci
&gt;     volumes: ---容器内数据文件存放路径
&gt;       - phpipam-db-data:/var/lib/mysql
&gt; 
&gt; volumes: ---通过卷标将数据持久化
&gt;   phpipam-db-data:
&gt;   phpipam-logo:
&gt; ```

**运行容器**
</code></pre>

<p>bash
docker-compose up -d
```</p>
</blockquote>

<h3>配置phpipam</h3>

<p><strong>打开地址：<a href="http://IP/phpipam">http://IP/phpipam</a></strong>
<strong>选择新的phpipam安装</strong>
<img src="img/phpipam/1.png" alt="img" />
<strong>安装pfpipam数据库</strong>
<img src="img/phpipam/2.png" alt="img" />
<strong>设置数据库</strong>
<img src="img/phpipam/3.png" alt="img" />
<img src="img/phpipam/4.png" alt="img" />
<strong>填写系统信息</strong>
<img src="img/phpipam/5.png" alt="img" />
<img src="img/phpipam/6.png" alt="img" />
<strong>登录</strong>
<img src="img/phpipam/7.png" alt="img" />
<img src="img/phpipam/8.png" alt="img" />
<strong>登录成功后会跳转到主界面</strong>
<img src="img/phpipam/9.png" alt="img" />
<strong>修改语言为中文，修改后重新登陆</strong>
<img src="img/phpipam/10.png" alt="img" />
<img src="img/phpipam/11.png" alt="img" />
<img src="img/phpipam/12.png" alt="img" />
<strong>子网创建，删除默认测试子网</strong>
<img src="img/phpipam/13.png" alt="img" />
<img src="img/phpipam/14.png" alt="img" />
<img src="img/phpipam/15.png" alt="img" />
<img src="img/phpipam/16.png" alt="img" />
<strong>子网页面</strong>
<img src="img/phpipam/17.png" alt="img" />
<strong>选中IP进行编辑</strong>
<img src="img/phpipam/18.png" alt="img" /></p>

    </div>
</div>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.2/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="../../js/search.js"></script>
<script>
    window.onload = function () {
        Prism.highlightAll();
    }
</script>